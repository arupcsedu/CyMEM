Casanova in the 18th century was one of the first reported using " assurance caps " to prevent impregnating his mistresses .